<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>è‡ªç„¶èªªæ˜“ï¼šæ˜“ç¶“æ¼”ç®—ç³»çµ± V22.52 - By å¤©ç‹æ˜Ÿ</title>
    <meta name="description" content="è‡ªç„¶èªªæ˜“ï¼šå°ˆæ¥­ã€ç°¡æ½”ã€å…è²»çš„ç·šä¸Šæ˜“ç¶“åœå¦ç³»çµ±ã€‚å¼·åŒ–æ–‡å­—ç´€éŒ„èˆ‡æ­·å²é€£çµåŠŸèƒ½ã€‚">
    <meta name="keywords" content="æ˜“ç¶“, åœå¦, å åœ, ç·šä¸Šåœå¦, å…­çˆ», è‡ªç„¶èªªæ˜“, å¤©ç‹æ˜Ÿ">
    <meta name="author" content="å¤©ç‹æ˜Ÿ">
    <meta name="google-site-verification" content="uF2V-AUqE4FMZDWEgfxw84J5fyM5m7ZMsAKPJ1HgRxw" />

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --paper-bg: #F7F3ED; --dai-blue: #1A2F4B; --gold-border: #D4AF37; }
        body { background-color: var(--paper-bg); font-family: "Microsoft JhengHei", sans-serif; }
        .gua-line-container { display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .gua-line { font-family: 'Courier New', monospace; font-weight: bold; font-size: 2.5rem; line-height: 1; height: 32px; display: flex; align-items: center; }
        .yang-line { color: #000000; } .yin-line { color: #e11d48; }  
        .moving-mark { background: linear-gradient(135deg, #fff3b0 0%, #e6c200 100%); border: 1px solid var(--gold-border); padding: 0px 10px; border-radius: 4px; position: relative; }
        .moving-mark::after { content: "è®Š"; position: absolute; right: -25px; top: 50%; transform: translateY(-50%); font-size: 12px; background: var(--gold-border); color: white; padding: 2px 4px; border-radius: 2px; }
        .mini-gua-line { font-size: 0.8rem; height: 8px; line-height: 1; gap: 2px; }
        @keyframes pulse-border {
            0% { border-color: #cbd5e1; box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
            50% { border-color: var(--gold-border); box-shadow: 0 0 12px 2px rgba(212, 175, 55, 0.4); }
            100% { border-color: #cbd5e1; box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
        }
        .next-yao-hint { animation: pulse-border 1.5s infinite; border: 2px solid var(--gold-border) !important; background-color: #fff !important; }
        select:disabled { background-color: #f1f5f9; cursor: not-allowed; opacity: 0.6; }
        .gold-card { border: 1px solid rgba(212, 175, 55, 0.3); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .history-link:hover { text-decoration: underline; color: #b45309; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="mx-auto max-w-5xl bg-white shadow-2xl rounded-3xl overflow-hidden gold-card">
        <div class="bg-[#1A2F4B] p-6 text-white text-center relative">
            <h1 class="text-2xl md:text-3xl font-bold italic tracking-tighter">è‡ªç„¶èªªæ˜“ï¼šæ˜“ç¶“æ¼”ç®—ç³»çµ± V22.52</h1>
            <p class="text-slate-400 text-xs mt-1">By å¤©ç‹æ˜Ÿ | ç‰©ç†ç¾å¯¦ Â· æ–‡å­—å®šæ¨™</p>
            <button onclick="toggleMute()" id="muteBtn" class="absolute right-6 top-1/2 -translate-y-1/2 bg-white/10 p-2 rounded-full transition hover:bg-white/20">
                <span id="muteIcon">ğŸ”Š</span>
            </button>
        </div>

        <div class="p-6 md:p-10">
            <div class="mb-6">
                <div class="flex justify-between text-xs font-bold text-slate-400 mb-1 uppercase tracking-widest">
                    <span>å åœé€²åº¦</span> <span id="progressText">0 / 6</span>
                </div>
                <div class="w-full bg-slate-100 h-2 rounded-full overflow-hidden border border-slate-200">
                    <div id="progressBar" class="bg-amber-500 h-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>

            <div class="bg-slate-50 p-6 rounded-2xl border border-slate-200 mb-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div><label class="block text-xs font-bold text-slate-500 mb-2 uppercase">å§“å</label>
                <input type="text" id="userName" placeholder="è«‹è¼¸å…¥å§“å" class="w-full border-2 border-slate-200 p-3 rounded-xl outline-none focus:border-blue-500"></div>
                <div><label class="block text-xs font-bold text-slate-500 mb-2 uppercase">æ—¥æœŸ</label>
                <input type="date" id="recordDate" class="w-full border-2 border-slate-200 p-3 rounded-xl outline-none focus:border-blue-500"></div>
                <div><label class="block text-xs font-bold text-slate-500 mb-2 uppercase">å åœäº‹é …</label>
                <input type="text" id="subject" placeholder="è«‹è¼¸å…¥å åœä¸»é¡Œ" class="w-full border-2 border-slate-200 p-3 rounded-xl outline-none focus:border-blue-500"></div>
            </div>

            <div class="flex flex-wrap gap-3 mb-8 justify-center">
                <button onclick="saveCurrentToHistory()" class="bg-amber-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg transition active:scale-95">ğŸ’¾ å„²å­˜ç´€éŒ„</button>
                <button onclick="exportJSON()" class="bg-indigo-600 text-white px-4 py-3 rounded-xl font-bold text-sm">ğŸ“¤ åŒ¯å‡ºå‚™ä»½</button>
                <label class="bg-indigo-50 text-indigo-700 px-4 py-3 rounded-xl font-bold text-sm cursor-pointer border border-indigo-200">ğŸ“¥ åŒ¯å…¥åˆä½µ <input type="file" class="hidden" onchange="importJSON(event)"></label>
                <button onclick="copyToClipboard()" class="bg-blue-600 text-white px-4 py-3 rounded-xl font-bold text-sm">ğŸ“‹ è¤‡è£½æ–‡å­—</button>
                <button onclick="resetSystem()" class="bg-slate-200 text-slate-600 px-4 py-3 rounded-xl font-bold text-sm hover:bg-red-600 hover:text-white">ğŸ—‘ï¸ é‡ç½®</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                <div class="bg-blue-50 p-6 rounded-2xl border-2 border-blue-100">
                    <h2 class="text-center font-bold text-blue-800 mb-4 tracking-widest">ã€ä¸‹å¦ã€‘</h2>
                    <div id="group-lower" class="flex flex-col-reverse gap-3"></div>
                </div>
                <div class="bg-emerald-50 p-6 rounded-2xl border-2 border-emerald-100">
                    <h2 class="text-center font-bold text-emerald-800 mb-4 tracking-widest">ã€ä¸Šå¦ã€‘</h2>
                    <div id="group-upper" class="flex flex-col-reverse gap-3"></div>
                </div>
            </div>

            <div id="resultArea" class="hidden border-t-4 border-double border-slate-200 pt-10">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 text-center">
                    <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-xl relative overflow-hidden gold-card">
                        <div class="absolute top-0 right-0 p-4" id="origMiniGua"></div>
                        <span class="text-xs font-bold text-slate-400 uppercase">æœ¬å¦</span>
                        <div id="origGuaLines" class="gua-line-container my-8"></div>
                        <div id="origGuaName" class="text-3xl font-bold text-slate-800 mb-4"></div>
                        <div id="origStructure" class="text-sm text-slate-400 mb-6 bg-slate-50 py-2 rounded-lg"></div>
                        <a id="origLink" target="_blank" class="bg-[#1A2F4B] text-white px-10 py-3 rounded-full font-bold inline-block">æŸ¥çœ‹è©³è§£</a>
                    </div>
                    <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-xl relative overflow-hidden gold-card">
                        <div class="absolute top-0 right-0 p-4" id="chanMiniGua"></div>
                        <span class="text-xs font-bold text-slate-400 uppercase">ä¹‹å¦</span>
                        <div id="chanGuaLines" class="gua-line-container my-8"></div>
                        <div id="chanGuaName" class="text-3xl font-bold text-slate-800 mb-4"></div>
                        <div id="chanStructure" class="text-sm text-slate-400 mb-6 bg-slate-50 py-2 rounded-lg"></div>
                        <a id="chanLink" target="_blank" class="bg-[#1A2F4B] text-white px-10 py-3 rounded-full font-bold inline-block">æŸ¥çœ‹è©³è§£</a>
                    </div>
                </div>
            </div>

            <div class="mt-16 border-t-2 border-slate-100 pt-10">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ğŸ“œ æ­·å²å åœç´€éŒ„</h2>
                <div id="historyContainer" class="flex flex-col gap-3"></div>
            </div>
        </div>
    </div>

    <script>
        let isMuted = localStorage.getItem('yijing_mute') === 'true';
        function toggleMute() { isMuted = !isMuted; localStorage.setItem('yijing_mute', isMuted); updateMuteUI(); }
        function updateMuteUI() { document.getElementById('muteIcon').innerText = isMuted ? "ğŸ”Š" : "ğŸ”‡"; }

        function playSound(type) {
            if (isMuted) return;
            if (navigator.vibrate) navigator.vibrate(60);
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain); gain.connect(ctx.destination);
            if(type === 'low') osc.frequency.setValueAtTime(180, ctx.currentTime);
            else if(type === 'high') osc.frequency.setValueAtTime(550, ctx.currentTime);
            else osc.frequency.setValueAtTime(280, ctx.currentTime);
            gain.gain.setValueAtTime(0.25, ctx.currentTime); 
            gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.5);
            osc.start(); osc.stop(ctx.currentTime + 0.5);
        }

        const baguaNames = { "111": "ä¹¾(å¤©)", "000": "å¤(åœ°)", "110": "å…Œ(æ¾¤)", "001": "è‰®(å±±)", "101": "é›¢(ç«)", "010": "å(æ°´)", "100": "éœ‡(é›·)", "011": "å·½(é¢¨)" };
        const yijingMap = { "111111": { name: "ä¹¾ç‚ºå¤©", id: "01" }, "000111": { name: "å¤©åœ°å¦", id: "12" }, "110111": { name: "å¤©æ¾¤å±¥", id: "10" }, "001111": { name: "å¤©å±±é¯", id: "33" }, "101111": { name: "å¤©ç«åŒäºº", id: "13" }, "010111": { name: "å¤©æ°´è¨Ÿ", id: "06" }, "100111": { name: "å¤©é›·æ— å¦„", id: "25" }, "011111": { name: "å¤©é¢¨å§¤", id: "44" }, "111000": { name: "åœ°å¤©æ³°", id: "11" }, "000000": { name: "å¤ç‚ºåœ°", id: "02" }, "110000": { name: "åœ°æ¾¤è‡¨", id: "19" }, "001000": { name: "åœ°å±±è¬™", id: "15" }, "101000": { name: "åœ°ç«æ˜å¤·", id: "36" }, "010000": { name: "åœ°æ°´å¸«", id: "07" }, "100000": { name: "åœ°é›·å¾©", id: "24" }, "011000": { name: "åœ°é¢¨å‡", id: "46" }, "111110": { name: "æ¾¤å¤©å¤¬", id: "43" }, "000110": { name: "æ¾¤åœ°èƒ", id: "45" }, "110110": { name: "å…Œç‚ºæ¾¤", id: "58" }, "001110": { name: "æ¾¤å±±å’¸", id: "31" }, "101110": { name: "æ¾¤ç«é©", id: "49" }, "010110": { name: "æ¾¤æ°´å›°", id: "47" }, "100110": { name: "æ¾¤é›·éš¨", id: "17" }, "011110": { name: "æ¾¤é¢¨å¤§é", id: "28" }, "111001": { name: "å±±å¤©å¤§ç•œ", id: "26" }, "000001": { name: "å±±åœ°å‰", id: "23" }, "110001": { name: "å±±æ¾¤æ", id: "41" }, "001001": { name: "è‰®ç‚ºå±±", id: "52" }, "101001": { name: "å±±ç«è³", id: "22" }, "010001": { name: "å±±æ°´è’™", id: "04" }, "100001": { name: "å±±é›·é ¤", id: "27" }, "011001": { name: "å±±é¢¨è ±", id: "18" }, "111101": { name: "ç«å¤©å¤§æœ‰", id: "14" }, "000101": { name: "ç«åœ°æ™‰", id: "35" }, "110101": { name: "ç«æ¾¤ç½", id: "38" }, "001101": { name: "ç«å±±æ—…", id: "56" }, "101101": { name: "é›¢ç‚ºç«", id: "30" }, "010101": { name: "ç«æ°´æœªæ¿Ÿ", id: "64" }, "100101": { name: "ç«é›·å™¬å—‘", id: "21" }, "011101": { name: "ç«é¢¨é¼", id: "50" }, "111010": { name: "æ°´å¤©éœ€", id: "05" }, "000010": { name: "æ°´åœ°æ¯”", id: "08" }, "110010": { name: "æ°´æ¾¤ç¯€", id: "60" }, "001010": { name: "æ°´å±±è¹‡", id: "39" }, "101010": { name: "æ°´ç«æ—¢æ¿Ÿ", id: "63" }, "010010": { name: "åç‚ºæ°´", id: "29" }, "100010": { name: "æ°´é›·å±¯", id: "03" }, "011010": { name: "æ°´é¢¨äº•", id: "48" }, "111100": { name: "é›·å¤©å¤§å£¯", id: "34" }, "000100": { name: "é›·åœ°è±«", id: "16" }, "110100": { name: "é›·æ¾¤æ­¸å¦¹", id: "54" }, "001100": { name: "é›·å±±å°é", id: "62" }, "101100": { name: "é›·ç«è±", id: "55" }, "010100": { name: "é›·æ°´è§£", id: "40" }, "100100": { name: "éœ‡ç‚ºé›·", id: "51" }, "011100": { name: "é›·é¢¨æ’", id: "32" }, "111011": { name: "é¢¨å¤©å°ç•œ", id: "09" }, "000011": { name: "é¢¨åœ°è§€", id: "20" }, "110011": { name: "é¢¨æ¾¤ä¸­å­š", id: "61" }, "001011": { name: "é¢¨å±±æ¼¸", id: "53" }, "101011": { name: "é¢¨ç«å®¶äºº", id: "37" }, "010011": { name: "é¢¨æ°´æ¸™", id: "59" }, "100011": { name: "é¢¨é›·ç›Š", id: "42" }, "011011": { name: "å·½ç‚ºé¢¨", id: "57" } };

        let historyData = [];
        const labels = ["åˆçˆ»", "äºŒçˆ»", "ä¸‰çˆ»", "å››çˆ»", "äº”çˆ»", "ä¸Šçˆ»"];

        function initYaoSelectors() {
            const lowDiv = document.getElementById('group-lower'); lowDiv.innerHTML = "";
            const uppDiv = document.getElementById('group-upper'); uppDiv.innerHTML = "";
            for(let i=0; i<6; i++) {
                const div = document.createElement('div');
                div.id = `yao-container-${i}`;
                div.className = `flex items-center bg-white p-2 rounded-lg border border-slate-200 transition-all ${i===0?'next-yao-hint':''}`;
                div.innerHTML = `<span class="w-16 text-[10px] font-bold text-slate-400">${labels[i]}</span>
                    <select id="yao-${i}" onchange="handleYaoChange(${i});" ${i===0?'':'disabled'} class="flex-1 bg-transparent p-1 font-bold outline-none cursor-pointer">
                        <option value="">è«‹è¼¸å…¥</option>
                        <option value="9">[ âš« âš« âš« ] ä¸‰æ­£ / è€é™½ / 9</option>
                        <option value="8">[ âš« âš« ğŸ”´ ] äºŒæ­£ä¸€å / å°‘é™° / 8</option>
                        <option value="7">[ âš« ğŸ”´ ğŸ”´ ] ä¸€æ­£äºŒå / å°‘é™½ / 7</option>
                        <option value="6">[ ğŸ”´ ğŸ”´ ğŸ”´ ] ä¸‰å / è€é™° / 6</option>
                    </select>`;
                if(i >= 3) uppDiv.appendChild(div); else lowDiv.appendChild(div);
            }
        }

        function handleYaoChange(index) {
            const current = document.getElementById(`yao-${index}`);
            const container = document.getElementById(`yao-container-${index}`);
            if(current.value !== "") {
                if(index === 5) playSound('finish'); else if(index >= 3) playSound('high'); else playSound('low');
                container.classList.remove('next-yao-hint');
                if(index < 5) {
                    const nextS = document.getElementById(`yao-${index+1}`);
                    const nextC = document.getElementById(`yao-container-${index+1}`);
                    nextS.disabled = false; nextC.classList.add('next-yao-hint');
                }
            }
            updateProgress(); run();
        }

        function updateProgress() {
            let count = 0; for(let i=0; i<6; i++) if(document.getElementById(`yao-${i}`).value !== "") count++;
            document.getElementById('progressBar').style.width = `${(count/6)*100}%`;
            document.getElementById('progressText').innerText = `${count} / 6`;
        }

        function run() {
            let data = []; for(let i=0; i<6; i++) {
                let v = document.getElementById(`yao-${i}`).value;
                if(!v) { document.getElementById('resultArea').classList.add('hidden'); return; }
                data.push(parseInt(v));
            }
            document.getElementById('resultArea').classList.remove('hidden');
            drawG('origGuaLines', data, false); drawG('chanGuaLines', data, true);
            drawG('origMiniGua', data, false, true); drawG('chanMiniGua', data, true, true);
            const getRes = (isC) => {
                let bits = data.map(v => isC ? ((v===6||v===7)?"1":"0") : ((v===7||v===9)?"1":"0")).join('');
                return { info: yijingMap[bits], l: baguaNames[bits.substring(0,3)], u: baguaNames[bits.substring(3,6)] };
            };
            const r1 = getRes(false); const r2 = getRes(true);
            document.getElementById('origGuaName').innerText = r1.info.name;
            document.getElementById('origStructure').innerText = `ä¸Š [${r1.u}] / ä¸‹ [${r1.l}]`;
            document.getElementById('origLink').href = `https://www.eee-learning.com/book/neweee${r1.info.id}`;
            document.getElementById('chanGuaName').innerText = r2.info.name;
            document.getElementById('chanStructure').innerText = `ä¸Š [${r2.u}] / ä¸‹ [${r2.l}]`;
            document.getElementById('chanLink').href = `https://www.eee-learning.com/book/neweee${r2.info.id}`;
        }

        function drawG(id, data, isC, mini = false) {
            const el = document.getElementById(id); el.innerHTML = "";
            [5,4,3,2,1,0].forEach(idx => {
                let v = data[idx]; let isY = isC ? (v===6||v===7) : (v===7||v===9);
                const d = document.createElement('div');
                d.className = (mini ? "mini-gua-line " : "gua-line ") + (isY?'yang-line':'yin-line');
                let s = isY ? "â€”â€”â€”â€”â€”â€”â€”" : "â€”â€”â€” â€”â€”â€”";
                if(!isC && !mini && (v===6||v===9)) d.innerHTML = `<span class="moving-mark">${s}</span>`; else d.innerText = s;
                el.appendChild(d);
            });
        }

        function saveCurrentToHistory() {
            const yaos = Array.from({length: 6}, (_, i) => document.getElementById(`yao-${i}`).value);
            if(yaos.some(v => v === "")) { alert("è«‹å…ˆå®Œæˆå åœã€‚"); return; }
            
            // ç²å–ç•¶å‰é€£çµèˆ‡ ID
            const getBits = (isC) => yaos.map(v => isC ? ((parseInt(v)===6||parseInt(v)===7)?"1":"0") : ((parseInt(v)===7||parseInt(v)===9)?"1":"0")).join('');
            const origID = yijingMap[getBits(false)].id;
            const chanID = yijingMap[getBits(true)].id;

            historyData.push({ 
                id: Date.now(), 
                name: document.getElementById('userName').value || "è¨ªå®¢", 
                date: document.getElementById('recordDate').value, 
                subject: document.getElementById('subject').value || "ç„¡ä¸»é¡Œ", 
                origName: document.getElementById('origGuaName').innerText, 
                chanName: document.getElementById('chanGuaName').innerText,
                origLink: `https://www.eee-learning.com/book/neweee${origID}`,
                chanLink: `https://www.eee-learning.com/book/neweee${chanID}`
            });
            localStorage.setItem('yijing_v21_db', JSON.stringify(historyData)); renderHistory(); alert("âœ… ç´€éŒ„å·²å„²å­˜ã€‚");
        }

        function renderHistory() {
            const container = document.getElementById('historyContainer'); container.innerHTML = "";
            [...historyData].reverse().forEach(item => {
                const card = document.createElement('div');
                card.className = "bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col md:flex-row justify-between items-start md:items-center gap-4 gold-card";
                card.innerHTML = `
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="bg-blue-100 text-blue-800 text-[10px] px-2 py-0.5 rounded font-bold">${item.date}</span>
                            <span class="font-bold text-slate-700">${item.name}ï¼š${item.subject}</span>
                        </div>
                        <div class="text-sm flex gap-3 text-slate-500">
                            <span>æœ¬å¦ï¼š<a href="${item.origLink}" target="_blank" class="font-bold text-amber-700 history-link">ã€${item.origName}ã€‘</a></span>
                            <span class="text-slate-300">â–¶</span>
                            <span>ä¹‹å¦ï¼š<a href="${item.chanLink}" target="_blank" class="font-bold text-emerald-700 history-link">ã€${item.chanName}ã€‘</a></span>
                        </div>
                    </div>
                    <button onclick="deleteEntry(${item.id})" class="text-slate-300 hover:text-red-500 transition px-2">åˆªé™¤</button>
                `;
                container.appendChild(card);
            });
        }

        function resetSystem() { if(confirm("ç¢ºå®šé‡ç½®ç•¶å‰è¼¸å…¥ï¼Ÿ")) { document.getElementById('userName').value = ""; document.getElementById('subject').value = ""; initYaoSelectors(); updateProgress(); document.getElementById('resultArea').classList.add('hidden'); } }
        function exportJSON() { const blob = new Blob([JSON.stringify(historyData)], { type: 'application/json' }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `natural_yijing_backup.json`; a.click(); }
        function importJSON(event) { const reader = new FileReader(); reader.onload = (e) => { const imported = JSON.parse(e.target.result); historyData = [...historyData, ...imported.filter(i => !new Set(historyData.map(d => d.id)).has(i.id))]; localStorage.setItem('yijing_v21_db', JSON.stringify(historyData)); renderHistory(); alert(`âœ… åŒ¯å…¥æˆåŠŸï¼`); }; reader.readAsText(event.target.files[0]); }
        function copyToClipboard() { const text = `ã€å åœç´€éŒ„ - è‡ªç„¶èªªæ˜“ By å¤©ç‹æ˜Ÿã€‘\nå§“åï¼š${document.getElementById('userName').value}\nä¸»é¡Œï¼š${document.getElementById('subject').value}\næœ¬å¦ï¼š${document.getElementById('origGuaName').innerText}\nä¹‹å¦ï¼š${document.getElementById('chanGuaName').innerText}`; navigator.clipboard.writeText(text).then(() => alert("ğŸ“‹ è¤‡è£½æˆåŠŸ")); }
        function deleteEntry(id) { if(confirm("åˆªé™¤æ­¤ç´€éŒ„ï¼Ÿ")) { historyData = historyData.filter(i => i.id !== id); localStorage.setItem('yijing_v21_db', JSON.stringify(historyData)); renderHistory(); } }

        window.onload = () => { 
            const saved = localStorage.getItem('yijing_v21_db'); if(saved) { historyData = JSON.parse(saved); renderHistory(); }
            document.getElementById('recordDate').valueAsDate = new Date();
            initYaoSelectors(); updateMuteUI();
        };
    </script>
</body>
</html>
